!function(a,b){"use strict";if("object"==typeof exports)module.exports=b(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(c){return a.Scrollgrid=b(c),a.Scrollgrid});else if(a.d3)a.Scrollgrid=b(a.d3);else{if(!console||!console.warn)throw"scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(a){"use strict";var b=function(b){var c=this.internal,d=c.sizes,e=c.interaction,f=c.render,g=c.dom,h=d.virtual,i=d.physical;b=b||{},b.target?1!==a.select(b.target).length?c.raise('target should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".  Please check that your selector is matching 1 and only 1 div.'):(i.rowHeight=b.rowHeight||30,i.dragHandleWidth=b.dragHandleWidth||8,i.headerRowHeight=b.headerRowHeight||i.rowHeight,i.footerRowHeight=b.footerRowHeight||i.rowHeight,i.defaultColumnWidth=b.defaultColumnWidth||100,i.cellPadding=b.cellPadding||6,i.verticalAlignment=b.verticalAlignment||"top",e.allowColumnResizing=b.allowColumnResizing||!0,e.allowSorting=b.allowSorting||!0,h.top=b.headerRows||0,h.bottom=b.footerRows||0,h.left=b.headerColumns||0,h.right=b.footerColumns||0,this.target=b.target,f.setDefaultStyles.call(this),f.formatRules=b.formatRules||[],f.cellWaitText=b.cellWaitText||"loading...",f.sortIconSize=b.sortIconSize||7,g.populateDOM.call(this),this.data(b.data||b.adapter),b.autoResize&&g.setAutoResize.call(this)):c.raise('target is a required field, please provide a selector string for the container. The selector string should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".')};return b.init=function(a,c){c.target=a;var d=new b(c);return d},b.adapters={},b.prototype.internal={sizes:{virtual:{},physical:{}},interaction:{},dom:{},render:{}},b.prototype.internal.dom.getTopMargin=function(a,b){var c,d=this.internal,e=d.sizes,f=e.physical,g=0;return a&&a.height&&b&&(c=b.node().offsetHeight,"middle"===f.verticalAlignment?g=(c-a.height)/2:"bottom"===f.verticalAlignment&&(g=c-a.height-1)),g},b.prototype.internal.dom.layoutDOM=function(a){var b,c=this,d=c.internal,e=d.dom,f=d.sizes,g=d.render,h=f.physical;e.parent.style("position","relative"),b=e.getTopMargin.call(c,a,e.parent),e.container.style("position","relative").style("width",a&&a.width?a.width+"px":"100%").style("height",a&&a.height?a.height+"px":"100%").style("padding-top",b+"px").style("font-size",0),e.container.node().offsetWidth>e.parent.node().offsetWidth&&e.container.style("width","100%"),e.container.node().offsetHeight>e.parent.node().offsetHeight&&e.container.style("margin-top","0px").style("height","100%"),f.calculatePhysicalBounds.call(c,b),e.setAbsolutePosition.call(c,e.left.svg,0,h.top+b,h.left,h.visibleInnerHeight),e.setRelativePosition.call(c,e.top.svg,h.left,h.visibleInnerWidth,h.top,"hidden"),e.setRelativePosition.call(c,e.main.viewport,h.left,h.visibleInnerWidth,h.visibleInnerHeight,"auto"),e.setAbsolutePosition.call(c,e.right.svg,h.left+h.visibleInnerWidth,h.top+b,h.right,h.visibleInnerHeight),e.setRelativePosition.call(c,e.bottom.svg,h.left,h.visibleInnerWidth,h.bottom,"hidden"),e.setAbsolutePosition.call(c,e.top.left.svg,0,b,h.left+h.dragHandleWidth/2,h.top),e.setAbsolutePosition.call(c,e.top.right.svg,h.left+h.visibleInnerWidth-h.dragHandleWidth/2,b,h.right+h.dragHandleWidth/2,h.top),e.setAbsolutePosition.call(c,e.bottom.left.svg,0,h.top+h.visibleInnerHeight+b,h.left,h.bottom),e.setAbsolutePosition.call(c,e.bottom.right.svg,h.left+h.visibleInnerWidth,h.top+h.visibleInnerHeight+b,h.right,h.bottom),e.setAbsolutePosition.call(c,e.main.svg,h.left,h.top+b,h.visibleInnerWidth,h.visibleInnerHeight),e.top.right.transform.attr("transform","translate("+h.dragHandleWidth/2+", 0)"),e.main.viewport.on("scroll",function(){g.draw.call(c)}),e.setScrollerSize.call(c),h.verticalScrollbarWidth=e.main.viewport.node().offsetWidth-e.main.viewport.node().clientWidth,h.horizontalScrollbarHeight=e.main.viewport.node().offsetHeight-e.main.viewport.node().clientHeight},b.prototype.internal.dom.populateDOM=function(){var b=this.internal,c=this.style,d=b.dom;d.parent=a.select(this.target),d.container=d.parent.append("div"),d.left=d.populatePanel.call(this,c.left.panel),d.top=d.populatePanel.call(this,c.top.panel),d.top.left=d.populatePanel.call(this,c.top.left.panel),d.top.right=d.populatePanel.call(this,c.top.right.panel),d.main=d.populatePanel.call(this,c.main.panel),d.main.viewport=d.container.append("div"),d.right=d.populatePanel.call(this,c.right.panel),d.bottom=d.populatePanel.call(this,c.bottom.panel),d.bottom.left=d.populatePanel.call(this,c.bottom.left.panel),d.bottom.right=d.populatePanel.call(this,c.bottom.right.panel),d.main.scroller=d.main.viewport.append("div")},b.prototype.internal.dom.populatePanel=function(a){var b=this.internal.dom,c={};return c.svg=b.container.append("svg"),c.svg.attr("class",a),c.transform=c.svg.append("g"),c.content=c.transform.append("g"),c},b.prototype.internal.dom.setAbsolutePosition=function(a,b,c,d,e){return a.style("position","absolute").style("overflow","hidden").style("left",b+"px").style("top",c+"px").style("width",d+"px").style("height",e+"px")},b.prototype.internal.dom.setAutoResize=function(){var a=this,b=window.onresize;window.onresize=function(){b&&b(),a.refresh()}},b.prototype.internal.dom.setRelativePosition=function(a,b,c,d,e){return a.style("overflow",e).style("position","relative").style("margin-left",b+"px").style("width",c+"px").style("height",d+"px")},b.prototype.internal.dom.setScrollerSize=function(){var a=this.internal,b=a.dom,c=a.sizes,d=c.physical;b.main.scroller.style("width",d.totalInnerWidth+"px").style("height",d.totalInnerHeight+"px")},b.prototype.internal.interaction.addResizeHandles=function(a,b,c){var d=this,e=d.internal,f=d.style,g=e.sizes,h=e.interaction,i=g.physical;a.selectAll(".sg-no-style--resize-handle-selector").remove(),a.selectAll(".sg-no-style--resize-handle-selector").data(b,function(a){return a.key}).enter().append("rect").attr("class","sg-no-style--resize-handle-selector "+f.resizeHandle).attr("transform","translate("+-1*i.dragHandleWidth/2+", 0)").attr("x",function(a){return a.x+(c?0:a.boxWidth)}).attr("y",0).attr("width",i.dragHandleWidth).attr("height",i.top).on("dblclick",function(a){h.autoResizeColumn.call(d,a)}).call(h.getColumnResizer.call(d,c))},b.prototype.internal.interaction.addSortButtons=function(a,b){var c,d=this,e=d.internal,f=e.interaction;c=a.selectAll(".sg-no-style--sort-button-selector").data(b,function(a){return a.key}),c.enter().append("rect").attr("class","sg-no-style--sort-button-selector").style("opacity",0).style("cursor","pointer").on("click",function(a){return f.sortColumn.call(d,a.columnIndex,!0)}),c.attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.boxWidth}).attr("height",function(a){return a.boxHeight}),c.exit().remove()},b.prototype.internal.interaction.autoResizeColumn=function(a){var b,c=this.internal,d=c.dom,e=c.sizes,f=[d.top.left,d.top,d.top.right,d.left,d.main,d.right,d.bottom.left,d.bottom,d.bottom.right];if(a&&a.column&&a.columnIndex){for(a.column.width=0,b=0;b<f.length;b+=1)a.column.width=Math.max(a.column.width,e.getExistingTextBound.call(this,f[b].svg,a.columnIndex).width);this.refresh()}},b.prototype.internal.interaction.columnResizeEnd=function(a){a.classed("dragging",!1)},b.prototype.internal.interaction.columnResizeStart=function(b){a.event.sourceEvent.stopPropagation(),b.classed("dragging",!0)},b.prototype.internal.interaction.columnResizing=function(b,c,d){d?c.column.width+=c.x-a.event.x:c.column.width-=c.x-a.event.x,c.x=a.event.x,c.column.width<0&&(c.column.width=0),b.attr("x",c.x),this.refresh()},b.prototype.internal.interaction.defaultComparer=function(a,b){var c;return c=isNaN(a)||isNaN(b)?new Date(a)-new Date(b):parseFloat(a)-parseFloat(b),isNaN(c)&&(c=b>a?-1:a>b?1:0),c},b.prototype.internal.interaction.getColumnResizer=function(b){var c=this.internal,d=c.interaction,e=this;return a.behavior.drag().origin(function(a){return a}).on("dragstart",function(b){d.columnResizeStart.call(e,a.select(this),b)}).on("drag",function(c){d.columnResizing.call(e,a.select(this),c,b)}).on("dragend",function(b){d.columnResizeEnd.call(e,a.select(this),b)})},b.prototype.internal.interaction.sortColumn=function(a,b){var c,d=this.internal,e=d.interaction,f=d.sizes,g=f.virtual;for(c=0;c<this.columns.length;c+=1)c!==a?delete this.columns[c].sort:b&&(this.columns[c].sort="desc"===this.columns[c].sort?"asc":"desc");this.adapter.sort(a,g.top,g.bottom,"desc"===this.columns[a].sort,this.columns[a].compareFunction||e.defaultComparer),this.refresh()},b.prototype.internal.raise=function(a){var b=this.reporter||console;if(!b||!b.error)throw a;b.error(a)},b.prototype.internal.render.applyRules=function(a){var b,c,d,e,f,g,h=this.internal,i=h.render,j=h.sizes,k=j.virtual,l={};if(i.formatRules)for(d=0;d<a.length;d+=1){for(l={},f=a[d].rowIndex+1,g=a[d].columnIndex+1,e=0;e<i.formatRules.length;e+=1)if(b=i.formatRules[e],i.matchRule.call(this,b.row,f,k.outerHeight)&&i.matchRule.call(this,b.column,g,k.outerWidth))for(c in b)b.hasOwnProperty(c)&&"row"!==c&&"column"!==c&&(l[c]=b[c]);l.formatter&&(a[d].formatter=l.formatter),l.alignment&&(a[d].alignment=l.alignment),l.cellPadding&&(a[d].cellPadding=l.cellPadding),l.backgroundStyle&&(a[d].backgroundStyle+=" "+l.backgroundStyle),l.foregroundStyle&&(a[d].foregroundStyle+=" "+l.foregroundStyle),l.backgroundRender&&(a[d].renderStack[0]=l.backgroundRender),l.foregroundRender&&(a[d].renderStack[1]=l.foregroundRender),l.textRender&&(a[d].renderStack[2]=l.textRender),l.fullRender&&(a[d].renderStack=[].concat(l.fullRender).concat(i.renderSortIcon))}},b.prototype.internal.render.calculateCellAdjustments=function(a,b){var c=this.internal,d=c.sizes,e=d.virtual,f=d.physical,g={x:0,y:0,boxHeight:0,boxWidth:0,textHeight:0,textWidth:0};return(a<e.top||a>=e.outerHeight-e.bottom)&&b===e.outerWidth-e.right-1&&(g.boxWidth+=f.verticalScrollbarWidth),(b<e.left||b>=e.outerWidth-e.right)&&a===e.outerHeight-e.bottom-1&&(g.boxHeight+=f.horizontalScrollbarHeight),a===e.top-1&&(g.boxHeight-=1),a===e.top&&a>0&&(g.boxHeight+=1,g.y-=1),b===e.left-1&&(g.boxWidth-=1),b===e.left&&b>0&&(g.boxWidth+=1,g.x-=1),a===e.outerHeight-1&&(g.boxHeight-=1),b===e.outerWidth-1&&(g.boxWidth-=1),a===e.top-1&&(g.sortIcon=this.columns[b]?this.columns[b].sort:void 0),g},b.prototype.internal.render.cropText=function(a,b){var c=a.node().getBBox().width,d=a.text(),e=c/d.length,f=Math.ceil(b/e)+1;for(a.datum().originalText=d,0>=f&&a.text("");c>b&&f>=0;)a.text(0===f?"":d.substring(0,f)),c=a.node().getBBox().width,f-=1},b.prototype.internal.render.draw=function(){var a,b,c=this.internal,d=c.render,e=c.sizes,f=c.dom,g=e.virtual,h=e.physical,i=d.getVisibleRegion.call(this),j=d.getDataBounds.call(this,i),k={},l=j.physical,m=j.virtual,n={top:{top:0,bottom:g.top},middle:{top:g.top+m.top,bottom:g.top+m.bottom},bottom:{top:g.outerHeight-g.bottom,bottom:g.outerHeight}},o={left:{left:0,right:g.left},middle:{left:g.left+m.left,right:g.left+m.right},right:{left:g.outerWidth-g.right,right:g.outerWidth}};d.renderRegion.call(this,f.top.left,{},o.left,n.top),d.renderRegion.call(this,f.top,{x:l.x},o.middle,n.top),d.renderRegion.call(this,f.top.right,{},o.right,n.top),d.renderRegion.call(this,f.left,{y:l.y},o.left,n.middle),d.renderRegion.call(this,f.main,{x:l.x,y:l.y},o.middle,n.middle),d.renderRegion.call(this,f.right,{y:l.y},o.right,n.middle),d.renderRegion.call(this,f.bottom.left,{},o.left,n.bottom),d.renderRegion.call(this,f.bottom,{x:l.x},o.middle,n.bottom),d.renderRegion.call(this,f.bottom.right,{},o.right,n.bottom),a=h.left+h.totalInnerWidth+h.right+h.verticalScrollbarWidth,k.width=a<f.parent.node().offsetWidth?a:null,b=h.top+h.totalInnerHeight+h.bottom+h.horizontalScrollbarHeight,k.height=b<f.parent.node().offsetHeight?b:null,f.layoutDOM.call(this,k)},b.prototype.internal.render.getDataBounds=function(a){var b,c,d,e,f=this.internal,g=this.columns,h=f.sizes,i=h.virtual,j=h.physical,k=0,l={physical:{x:0,y:0},virtual:{top:Math.max(Math.floor(i.innerHeight*(a.top/j.totalInnerHeight)-1),0),bottom:Math.min(Math.ceil(i.innerHeight*(a.bottom/j.totalInnerHeight)+1),i.innerHeight)}};for(l.physical.y=l.virtual.top*j.rowHeight-a.top,b=0;b<i.innerWidth;b+=1){if(c=g[b+i.left].width,void 0===d&&(b===i.innerWidth-1||k+c>a.left)&&(d=b,l.physical.x=k-a.left),void 0===e&&(b===i.innerWidth-1||k+c>a.right)){e=b+1;break}k+=c}return l.virtual.left=Math.max(Math.floor(d),0),l.virtual.right=Math.min(Math.ceil(e+1),i.innerWidth),l},b.prototype.internal.render.getDataInBounds=function(a){var b,c,d,e,f,g,h,i,j,k=this.internal,l=k.sizes,m=k.render,n=l.physical,o=this.columns,p=0,q=[];for(h=a.startY,j=this.adapter.loadDataRange(a),c=a.top||0,b=0;c<a.bottom;c+=1){for(p=n.getRowHeight.call(this,c),g=a.startX||0,d=a.left||0;d<a.right;d+=1,b+=1)i=m.calculateCellAdjustments.call(this,c,d),f=o[d],e=Math.floor(g)+i.x+.5,q[b]={key:d+"_"+c,x:e,y:Math.floor(h)+i.y+.5,boxWidth:Math.ceil(f.width)+i.boxWidth,boxHeight:Math.ceil(p)+i.boxHeight,textWidth:Math.ceil(f.width)+i.textWidth,textHeight:Math.ceil(p)+i.textHeight,backgroundStyle:this.style.cellBackgroundPrefix+"r"+(c+1)+" "+this.style.cellBackgroundPrefix+"c"+(d+1),foregroundStyle:this.style.cellForegroundPrefix+"r"+(c+1)+" "+this.style.cellForegroundPrefix+"c"+(d+1),sortIcon:i.sortIcon||"none",cellPadding:n.cellPadding,alignment:"left",rowIndex:c,columnIndex:d,column:f,formatter:null,getValue:j,renderStack:[m.renderBackground,m.renderForeground,m.renderText,m.renderSortIcon]},g+=f.width;h+=p}return m.applyRules.call(this,q),q},b.prototype.internal.render.getTextAnchor=function(a){var b="start";return"center"===a.alignment?b="middle":"right"===a.alignment&&(b="end"),b},b.prototype.internal.render.getTextPosition=function(a){var b,c=this.internal,d=c.render;return"center"===a.alignment?b=a.textWidth/2:"right"===a.alignment?b=a.textWidth-a.cellPadding:(b=a.cellPadding,a.sortIcon&&"none"!==a.sortIcon&&(b+=d.sortIconSize+a.cellPadding)),b},b.prototype.internal.render.getVisibleRegion=function(){var a,b=this.internal,c=b.dom;return a={},a.left=c.main.viewport.node().scrollLeft,a.top=c.main.viewport.node().scrollTop,a.right=a.left+c.main.viewport.node().clientWidth,a.bottom=a.top+c.main.viewport.node().clientHeight,a},b.prototype.internal.render.matchRule=function(a,b,c){var d,e,f,g,h,i=!1;if(a&&"*"!==a)for(d=a.toString().replace(/\s/g,"").split(","),h=0;h<d.length&&(e=d[h].indexOf(":"),-1!==e?(f=parseFloat(d[h].substring(0,e)),g=parseFloat(d[h].substring(e+1))):(f=parseFloat(d[h]),g=f),f=0>f?c+f+1:f,g=0>g?c+g+1:g,!(i=i||Math.min(f,g)<=b&&Math.max(f,g)>=b));h+=1);else i=!0;return i},b.prototype.internal.render.renderBackground=function(a,b,c){var d="sg-no-style--background-selector";c?a.append("rect").attr("class",d+" "+b.backgroundStyle):a.selectAll("."+d).attr("width",b.boxWidth).attr("height",b.boxHeight)},b.prototype.internal.render.renderCell=function(a,b,c){var d;if(b.renderStack&&b.renderStack.length>0)for(d=0;d<b.renderStack.length;d+=1)b.renderStack[d]&&b.renderStack[d].call(this,a,b,c)},b.prototype.internal.render.renderText=null,b.prototype.internal.render.renderRegion=function(b,c,d,e){var f,g=this,h=g.internal,i=h.render,j=h.interaction,k=h.sizes,l=k.physical,m=h.dom,n=i.getDataInBounds.call(this,{startX:c.x||0,startY:c.y||0,top:e.top||0,bottom:e.bottom||0,left:d.left||0,right:d.right||0});b.content.selectAll(".sg-no-style--sort-icon-selector").remove(),f=b.content.selectAll(".sg-no-style--cell-selector").data(n,function(a){return a.key}),f.enter().append("g").attr("class","sg-no-style--cell-selector").each(function(b){i.renderCell.call(g,a.select(this),b,!0)}),f.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).each(function(b){i.renderCell.call(g,a.select(this),b,!1)}),f.exit().remove(),(b===m.top||b===m.top.left||b===m.top.right)&&(j.allowSorting&&j.addSortButtons.call(this,b.content,n),j.allowColumnResizing&&j.addResizeHandles.call(this,b.content,n,b===m.top.right&&l.totalInnerWidth>l.visibleInnerWidth))},b.prototype.internal.render.renderSortIcon=function(a,b){var c,d,e=this,f=e.internal,g=f.render,h=g.sortIconSize,i=!(!b.sortIcon||"none"===b.sortIcon),j="sg-no-style--sorticon-selector";a.selectAll("."+j).remove(),i&&b.textWidth>b.cellPadding+g.sortIconSize&&(c=a.append("path").attr("class",j+" "+this.style.sortIcon),"asc"===b.sortIcon?c.attr("d","M "+h/2+" 0 L "+h+" "+h+" L 0 "+h+" z"):"desc"===b.sortIcon&&c.attr("d","M 0 0 L "+h+" 0 L "+h/2+" "+h+" z"),d=c.node().getBBox(),c.attr("transform","translate("+(b.cellPadding+g.sortIconSize/2+d.width/-2)+","+(b.textHeight/2+c.node().getBBox().height/-2)+")"))},b.prototype.internal.render.renderText=function(a,b,c){var d,e=this.internal,f=e.render,g=!(!b.sortIcon||"none"===b.sortIcon),h="sg-no-style--foreground-selector";c?a.append("text").attr("class",h+" "+b.foregroundStyle).style("text-anchor",f.getTextAnchor.call(this,b)).attr("dy","0.35em").text(f.cellWaitText):(d=a.selectAll("."+h).attr("x",f.getTextPosition.call(this,b)).attr("y",b.boxHeight/2),b.getValue(b.rowIndex,b.columnIndex,function(a){d.text(b.formatter?b.formatter(a):a),f.cropText.call(this,d,b.textWidth-b.cellPadding-(g?f.sortIconSize+b.cellPadding:0))}))},b.prototype.internal.render.setDefaultStyles=function(){this.style={left:{panel:"sg-fixed sg-left"},top:{panel:"sg-fixed sg-top",left:{panel:"sg-fixed sg-top-left"},right:{panel:"sg-fixed sg-top-right"}},right:{panel:"sg-fixed sg-right",left:{panel:"sg-fixed sg-top-left"}},bottom:{panel:"sg-fixed sg-bottom",left:{panel:"sg-fixed sg-bottom-left"},right:{panel:"sg-fixed sg-bottom-right"}},main:{panel:"sg-grid"},resizeHandle:"sg-resize-handle",cellBackgroundPrefix:"sg-cell-background-",cellForegroundPrefix:"sg-cell-foreground-",sortIcon:"sg-sort-icon"}},b.prototype.internal.sizes.calculatePhysicalBounds=function(a){var b,c=this.internal,d=c.sizes,e=d.virtual,f=d.physical;for(f.left=0,b=0;b<e.left;b+=1)f.left+=this.columns[b].width;for(f.totalInnerWidth=0,b=e.left;b<e.outerWidth-e.right;b+=1)f.totalInnerWidth+=this.columns[b].width;for(f.right=0,b=e.outerWidth-e.right;b<e.outerWidth;b+=1)f.right+=this.columns[b].width;f.top=e.top*f.headerRowHeight,f.bottom=e.bottom*f.footerRowHeight,f.visibleInnerWidth=c.dom.container.node().offsetWidth-f.left-f.right,f.visibleInnerHeight=c.dom.container.node().offsetHeight-f.top-f.bottom-a,f.totalInnerHeight=e.innerHeight*f.rowHeight},b.prototype.internal.sizes.calculateTextBound=function(a,b){var c,d,e={width:0,height:0};return c=a.append("text").text(b),d=c.node().getBBox(),e.width=d.width,e.height=d.height,c.remove(),e},b.prototype.internal.sizes.getExistingTextBound=function(b,c,d){var e=this.internal,f=e.render,g={width:0,height:0};return b.selectAll("text").filter(function(a){return!(void 0!==c&&a.columnIndex!==c||void 0!==d&&a.rowIndex!==d)}).each(function(b){var c,d=a.select(this),e=d.text();d.text(d.datum().originalText||d.text()),c=d.node().getBBox(),c.width+2*b.cellPadding>g.width&&(g.width=c.width+2*b.cellPadding+(b.sortIcon&&"none"!==b.sortIcon?f.sortIconSize+b.cellPadding:0)),c.height>g.height&&(g.height=c.height),d.text(e)}),g},b.prototype.internal.sizes.physical.getRowHeight=function(a){var b=this.internal,c=b.sizes,d=c.physical,e=c.virtual,f=0;return f=a<e.top?d.headerRowHeight:a<e.outerHeight-e.bottom?d.rowHeight:d.footerRowHeight},b.prototype.internal.sizes.physical.initialiseColumns=function(){var a,b,c=this.internal,d=c.render,e=c.sizes,f=e.physical,g=e.virtual;for(this.columns=this.columns||[],a=0;a<g.outerWidth;a+=1)if(this.columns[a]=this.columns[a]||{},this.columns[a].width=this.columns[a].width||f.defaultColumnWidth,d.formatRules&&d.formatRules.length>0)for(b=0;b<d.formatRules.length;b+=1)d.matchRule.call(this,d.formatRules[b].column,a+1,g.outerWidth)&&(this.columns[a]={width:d.formatRules[b].columnWidth||this.columns[a].width,sort:d.formatRules[b].sort||this.columns[a].sort,compareFunction:d.formatRules[b].compareFunction||this.columns[a].compareFunction})},b.adapters.json=function(a,b,c){c=c||{};var d,e,f={},g={},h=b||[],i=a,j=c.rowSampleSize||100;if(0===h.length)for(e=0;e<Math.min(i.length,j);e+=1)for(d in i[e])i[e].hasOwnProperty(d)&&void 0===f[d]&&(f[d]=h.length,h.push(d));for(e=0;e<h.length;e+=1)g[h[e]]=h[e];return i.splice(0,0,g),{rowCount:function(){return i.length},columnCount:function(){return h.length},sort:function(a,b,c,d,e){var f,g=i.splice(0,b),j=i.splice(i.length-c);for(i.sort(function(b,c){return e(b[h[a]],c[h[a]])*(d?-1:1)}),f=g.length-1;f>=0;f-=1)i.splice(0,0,g[f]);for(f=0;f<j.length;f+=1)i.push(j[f])},loadDataRange:function(){return function(a,b,c){c(i[a][h[b]]||0)}}}},b.adapters.simple=function(a,b){b=b||{};var c,d=0,e=a,f=b.rowSampleSize||100;for(c=0;c<Math.min(e.length,f);c+=1)e[c]&&"[object Array]"===Object.prototype.toString.call(e[c])&&e[c].length>d&&(d=e[c].length);return{rowCount:function(){return e.length},columnCount:function(){return d},sort:function(a,b,c,d,f){var g,h=e.splice(0,b),i=e.splice(e.length-c);for(e.sort(function(b,c){return f(b[a],c[a])*(d?-1:1)}),g=h.length-1;g>=0;g-=1)e.splice(0,0,h[g]);for(g=0;g<i.length;g+=1)e.push(i[g])},loadDataRange:function(){return function(a,b,c){c(e[a][b])}}}},b.prototype.data=function(a){var c,d=this.internal,e=d.sizes,f=e.physical,g=e.virtual,h=d.interaction;if(a){for(this.adapter="[object Array]"===Object.prototype.toString.call(a)?b.adapters.simple(a):a,g.outerHeight=this.adapter.rowCount(),g.outerWidth=this.adapter.columnCount(),f.initialiseColumns.call(this),c=0;c<this.columns.length;c+=1)("asc"===this.columns[c].sort||"desc"===this.columns[c].sort)&&h.sortColumn.call(this,c,!1);g.innerWidth=g.outerWidth-g.left-g.right,g.innerHeight=g.outerHeight-g.top-g.bottom,this.refresh()}return this.adapter},b.prototype.refresh=function(){var a=this.internal,b=a.render,c=a.dom;c.layoutDOM.call(this),b.draw.call(this),c.setScrollerSize.call(this)},b});